---
interface Props {
	items: Array<{ name: string; url: string }>;
}

const { items } = Astro.props;
const baseUrl = import.meta.env.BASE_URL;

const getUrl = (path: string) => {
	if (path.startsWith('/')) {
		return `${baseUrl}${baseUrl.endsWith('/') ? path.slice(1) : path}`;
	}
	return path;
};

// パンくずリストの構造化データ
const breadcrumbStructuredData = {
	'@context': 'https://schema.org',
	'@type': 'BreadcrumbList',
	itemListElement: items.map((item, index) => ({
		'@type': 'ListItem',
		position: index + 1,
		name: item.name,
		item: new URL(getUrl(item.url), Astro.site || Astro.url.origin).toString(),
	})),
};
---

<nav aria-label="パンくずリスト" class="breadcrumb">
	<ol>
		{items.map((item, index) => (
			<li>
				{index < items.length - 1 ? (
					<a href={getUrl(item.url)}>{item.name}</a>
				) : (
					<span>{item.name}</span>
				)}
			</li>
		))}
	</ol>
</nav>
<script type="application/ld+json" set:html={JSON.stringify(breadcrumbStructuredData)} />

<style>
	.breadcrumb {
		margin-bottom: 1.5em;
		font-size: 0.9em;
	}
	
	.breadcrumb ol {
		display: flex;
		flex-wrap: wrap;
		list-style: none;
		padding: 0;
		margin: 0;
		gap: 0.5em;
		align-items: center;
	}
	
	.breadcrumb li {
		display: flex;
		align-items: center;
	}
	
	.breadcrumb li:not(:last-child)::after {
		content: '/';
		margin-left: 0.5em;
		color: rgb(var(--gray));
	}
	
	.breadcrumb a {
		color: var(--accent);
		text-decoration: none;
	}
	
	.breadcrumb a:hover {
		text-decoration: underline;
	}
	
	.breadcrumb span {
		color: rgb(var(--gray-dark));
	}
</style>
